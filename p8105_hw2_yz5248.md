p8105_hw2_yz5248
================
yz5248
2025-09-24

``` r
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   4.0.0     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(lubridate)
library(janitor)
```

    ## 
    ## Attaching package: 'janitor'
    ## 
    ## The following objects are masked from 'package:stats':
    ## 
    ##     chisq.test, fisher.test

``` r
library(readr)
library(readxl)
```

\#Problem 1.  
Dealing with the data in pols-month.csv.

``` r
pols_df = read_csv("fivethirtyeight_datasets/pols-month.csv")|>
  separate(mon, into = c("year", "month", "day"), sep = "-") |>
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    month = month.name[month],
    president = if_else(prez_gop == 1, "gop", "dem")
  ) |>
  select(-prez_gop, -prez_dem, -day)
pols_df
```

    ## # A tibble: 822 × 9
    ##     year month     gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <int> <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 January        23      51     253      23      45     198 dem      
    ##  2  1947 February       23      51     253      23      45     198 dem      
    ##  3  1947 March          23      51     253      23      45     198 dem      
    ##  4  1947 April          23      51     253      23      45     198 dem      
    ##  5  1947 May            23      51     253      23      45     198 dem      
    ##  6  1947 June           23      51     253      23      45     198 dem      
    ##  7  1947 July           23      51     253      23      45     198 dem      
    ##  8  1947 August         23      51     253      23      45     198 dem      
    ##  9  1947 September      23      51     253      23      45     198 dem      
    ## 10  1947 October        23      51     253      23      45     198 dem      
    ## # ℹ 812 more rows

pols_df from FiveThirtyEight contains 822 monthly observations of
political office holdings in the United States, spanning the years 1947
to 2014. Each observation related to the number of national politicians
who are democratic or republican at any given time, including gov_gop
and gov_dem (number of Republican and Democratic governors), sen_gop and
sen_dem (senators), and rep_gop and rep_dem (representatives). The
dataset also includes indicators for the party of the sitting president
(prez_gop and prez_dem). The ‘mon’ variable in the original file was
converted to separate ‘year’ and ‘month’ columns for clarity.

Dealing with the data in snp.csv.

``` r
snp_df = read_csv("fivethirtyeight_datasets/snp.csv") |>
  separate(date, into = c("month", "day", "year"), sep = "/") |> 
  mutate(
    year = as.integer(if_else(as.integer(year) > 50, paste0("19", year), paste0("20", year))),
    month = as.integer(month),
    month = month.name[month]
  ) |>
  select(year, month, close) |>
  arrange(year, match(month, month.name))
snp_df
```

    ## # A tibble: 787 × 3
    ##     year month     close
    ##    <int> <chr>     <dbl>
    ##  1  1951 January    21.7
    ##  2  1951 February   21.8
    ##  3  1951 March      21.5
    ##  4  1951 April      22.4
    ##  5  1951 May        21.5
    ##  6  1951 June       21.0
    ##  7  1951 July       22.4
    ##  8  1951 August     23.3
    ##  9  1951 September  23.3
    ## 10  1951 October    22.9
    ## # ℹ 777 more rows

snp_df dataset related to Standard & Poor’s stock market index (S&P),
often used as a representative measure of stock market as a whole and
provided for this analysis contains 787 monthly observations from 1951
onward, with two key variables: date, the observation date, and close,
the closing value of the S&P 500 index on that date.

Dealing with the data in unemployment.cvs

``` r
unemp_df = read_csv("fivethirtyeight_datasets/unemployment.csv")|>
  pivot_longer(
    cols = Jan:Dec,
    names_to = "month",
    values_to = "unemployment"
  ) |>
  mutate(month = recode(month,
                        Jan="January", Feb="February", Mar="March",
                        Apr="April", May="May", Jun="June",
                        Jul="July", Aug="August", Sep="September",
                        Oct="October", Nov="November", Dec="December")) |>
  rename(year = Year)
unemp_df
```

    ## # A tibble: 816 × 3
    ##     year month     unemployment
    ##    <dbl> <chr>            <dbl>
    ##  1  1948 January            3.4
    ##  2  1948 February           3.8
    ##  3  1948 March              4  
    ##  4  1948 April              3.9
    ##  5  1948 May                3.5
    ##  6  1948 June               3.6
    ##  7  1948 July               3.6
    ##  8  1948 August             3.9
    ##  9  1948 September          3.8
    ## 10  1948 October            3.7
    ## # ℹ 806 more rows

unemp_df dataset contains monthly U.S. unemployment rates from 1948 to
2015, with 816 observations and three variables: year, month, and
unemployment rate in the month of the associated year.

Merging the datasets and give brief discription

``` r
merged_df = pols_df |>
  left_join(snp_df, by = c("year", "month")) |>
  left_join(unemp_df, by = c("year", "month"))

merged_df
```

    ## # A tibble: 822 × 11
    ##     year month   gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1947 January      23      51     253      23      45     198 dem          NA
    ##  2  1947 Februa…      23      51     253      23      45     198 dem          NA
    ##  3  1947 March        23      51     253      23      45     198 dem          NA
    ##  4  1947 April        23      51     253      23      45     198 dem          NA
    ##  5  1947 May          23      51     253      23      45     198 dem          NA
    ##  6  1947 June         23      51     253      23      45     198 dem          NA
    ##  7  1947 July         23      51     253      23      45     198 dem          NA
    ##  8  1947 August       23      51     253      23      45     198 dem          NA
    ##  9  1947 Septem…      23      51     253      23      45     198 dem          NA
    ## 10  1947 October      23      51     253      23      45     198 dem          NA
    ## # ℹ 812 more rows
    ## # ℹ 1 more variable: unemployment <dbl>

``` r
tibble(
  Rows = nrow(merged_df),
  Columns = ncol(merged_df),
  Year_Min = min(merged_df$year, na.rm = TRUE),
  Year_Max = max(merged_df$year, na.rm = TRUE)
)
```

    ## # A tibble: 1 × 4
    ##    Rows Columns Year_Min Year_Max
    ##   <int>   <int>    <dbl>    <dbl>
    ## 1   822      11     1947     2015

resulting dataset is a tidy, merged compilation of political, economic,
and financial data, containing 822 rows and 11 variables, spanning the
years 1947 to 2015. Key variables include ‘year’ and ‘month’ to identify
the time period, political seat counts for Republicans and Democrats in
the House and Senate (gov_gop, sen_gop, rep_gop, gov_dem, sen_dem,
rep_dem), the party of the sitting president (president), the monthly
closing value of the S&P 500 (close), and the monthly U.S. unemployment
rate (unemployment).

\#Problem 2.

``` r
mr_trash_wheel = read_excel(
  "202409 Trash Wheel Collection Data.xlsx",sheet = "Mr. Trash Wheel", skip = 1) |>
  janitor::clean_names() |>       # make column names snake_case
  filter(!is.na(dumpster)) |>     # keep only rows with data
  mutate(
    year = as.integer(year),
    sports_balls = as.integer(round(sports_balls)),
    trash_wheel = "Mr. Trash Wheel"
  )
```

``` r
prof_trash_wheel = read_excel(
  "202409 Trash Wheel Collection Data.xlsx",
  sheet = "Professor Trash Wheel",
  skip = 1,
) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster))|>
  mutate(
    year = as.integer(year)
  )

gwynnda = read_excel(
  "202409 Trash Wheel Collection Data.xlsx",
  sheet = "Gwynnda Trash Wheel",
  skip = 1,
) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster))|>
  mutate(
    year = as.integer(year)
  )

trash_wheel_data = bind_rows(mr_trash_wheel, prof_trash_wheel, gwynnda)
```

\#Problem 3.

``` r
zip_df = read_csv(
  "zillow_data/Zip Codes.csv"
  ) |> 
  janitor::clean_names() |>
  mutate(zip = str_pad(as.character(zip_code), 5, pad = "0")) |>
  distinct(zip, .keep_all = TRUE)

zori_wide = read_csv(
  "zillow_data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv"
  ) |> 
  janitor::clean_names()
```

``` r
zori_long = zori_wide |>
  pivot_longer(
    cols = starts_with("x"),  
    names_to = "date",
    values_to = "zori"
  ) |>
  mutate(
    date = ymd(str_remove(date, "^x")),  
    zori = as.numeric(zori),
    zip = str_pad(region_name, 5, pad = "0")  
  ) |>
  drop_na(zori)

view(zori_long)
```

``` r
zori_merged = zori_long |>
  left_join(zip_df, by = "zip") |>
  select(zip, county, neighborhood, date, zori, everything())

zori_merged
```

    ## # A tibble: 10,450 × 19
    ##    zip   county neighborhood    date        zori region_id size_rank region_name
    ##    <chr> <chr>  <chr>           <date>     <dbl>     <dbl>     <dbl>       <dbl>
    ##  1 11368 Queens West Queens     2024-07-31 2322.     62080         4       11368
    ##  2 11368 Queens West Queens     2024-08-31 2282.     62080         4       11368
    ##  3 11385 Queens West Central Q… 2016-05-31 2266.     62093         7       11385
    ##  4 11385 Queens West Central Q… 2016-06-30 2292.     62093         7       11385
    ##  5 11385 Queens West Central Q… 2016-07-31 2321.     62093         7       11385
    ##  6 11385 Queens West Central Q… 2016-08-31 2343.     62093         7       11385
    ##  7 11385 Queens West Central Q… 2016-09-30 2337.     62093         7       11385
    ##  8 11385 Queens West Central Q… 2016-10-31 2345.     62093         7       11385
    ##  9 11385 Queens West Central Q… 2016-11-30 2320.     62093         7       11385
    ## 10 11385 Queens West Central Q… 2016-12-31 2326.     62093         7       11385
    ## # ℹ 10,440 more rows
    ## # ℹ 11 more variables: region_type <chr>, state_name <chr>, state <chr>,
    ## #   city <chr>, metro <chr>, county_name <chr>, state_fips <dbl>,
    ## #   county_code <chr>, county_fips <dbl>, zip_code <dbl>, file_date <chr>

The dataset contains 10450 total observations, covering 149 unique ZIP
codes in the ZORI data and 320 unique ZIP codes in the lookup table. The
number of unique neighborhoods is 43.
